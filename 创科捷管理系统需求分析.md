

## 一、需求

1、业务人员填写事务信息，包括客户单位，客户信息（第二次可选择该单位并自动填写客户信息），转任务到技术主管

2、技术主管分发任务到技术人员

3、技术人员在外出前填写该任务的开始时间及结束时间

4、技术人员在任务完成后点击完成按钮，选择是否有单

5、完成后发送到技术主管及财务管理人员



## 二、功能



## 三、表设计



### 1. 业务类型(tb_type)

| 字段名  | 类型          | 是否可为空 | 描述       |
| ------- | ------------- | ---------- | ---------- |
| type_id | int           | 否         | 业务类型id |
| name    | varchar（30） | 否         | 业务名称   |



### 2. 工单(tb_order)

| 字段名        | 类型     | 是否可为空 | 描述                                                 |
| :------------ | -------- | ---------- | ---------------------------------------------------- |
| order_id      | int      | 否         | 订单id                                               |
| customer_id   | int      | 是         | 客户id                                               |
| customer_name | varchar  | 否         | 客户名称（企业）                                     |
| content       | varchar  | 是         | 内容                                                 |
| detail        | varchar  | 是         | 订单备注                                             |
| leader        | varchar  | 是         | 分配人                                               |
| worker_id     | int      | 是         | 负责人id                                             |
| worker        | varchar  | 是         | 负责人（即技术员工）                                 |
| task_time     | datetime | 是         | 工单任务时间                                         |
| begin_time    | datetime | 是         | 出发时间                                             |
| end_time      | datetime | 是         | 返回时间                                             |
| finish_time   | datetime | 否         | 完成时间                                             |
| status        | tinyint  | 否         | 工单状态：0：未分配，1：未接受，2：进行中，3：已完成 |
| is_order      | tinyint  | 否         | 是否有单：0：无单，1：有单                           |
| img_list      | varchar  | 是         | 图片地址列表                                         |
| create_by     | varchar  | 否         | 创建人                                               |
| create_time   | datetime | 否         | 创建时间                                             |
| update_by     | varchar  | 否         | 更新人                                               |
| update_time   | datetime | 否         | 更新时间                                             |
| is_deleted    | tinyint  | 否         | 是否删除：0：未删除，1：已删除                       |



### 3. 维修记录单(tb_repair)

| 字段名        | 类型         | 是否可为空 | 描述                  |
| ------------- | ------------ | ---------- | --------------------- |
| repair_id     | int          | 否         | 维修记录单id          |
| customer_id   | int          | 否         | 客户id                |
| customer_name | varchar      | 否         | 客户(企业)名称        |
| equipment     | varchar(255) | 是         | 设备信息              |
| damage        | varchar      | 是         | 故障情况              |
| task          | varchar      | 是         | 处理事项              |
| detail        | varchar      | 是         | 备注                  |
| take_time     | datetime     | 否         | 带走时间              |
| back_time     | datetime     | 是         | 送回时间              |
| status        | tinyint      | 否         | 状态0:未送回,1:已送回 |
| create_by     | varchar      | 否         | 创建人(填写人)        |
| create_time   | datetime     | 否         | 创建时间              |
| update_by     | varcahr      | 是         | 更新人                |
| update_time   | datetime     | 是         | 更新时间              |



### 4. 客户(tb_customer)

| 字段名        | 类型     | 是否可为空 | 描述           |
| ------------- | -------- | ---------- | -------------- |
| customer_id   | int      | 否         | 客户（企业）id |
| customer_name | varchar  | 是         | 客户名称       |
| department    | varchar  | 是         | 部门           |
| address       | varchar  | 是         | 地址           |
| contact_man   | varchar  | 是         | 联系人         |
| phone         | int      | 是         | 联系电话       |
| create_time   | datetime | 否         | 录入时间       |
| update_time   | datetime | 是         | 更新时间       |



### 5. 员工(tb_employee)

| 字段名      | 类型    | 是否可为空 | 描述           |
| ----------- | ------- | ---------- | -------------- |
| employee_id | int     | 否         | 员工id         |
| user_id     | int     | 是         | 企业微信唯一id |
| name        | varchar | 是         | 员工姓名       |
| username    | varcahr | 否         | 员工账户名     |
| password    | varchar | 否         | 密码           |
| department  | varchar | 否         | 部门           |
| position    | varchar | 否         | 岗位           |



### 6. 角色(tb_role）

| 字段名  | 类型    | 是否可为空 | 描述   |
| ------- | ------- | ---------- | ------ |
| role_id | int     | 否         | 角色id |
| name    | varchar | 否         | 角色名 |



### 7. 权限(tb_menu)

| 字段名     | 类型    | 是否可为空 | 描述     |
| ---------- | ------- | ---------- | -------- |
| menu_id    | int     | 否         | 权限id   |
| type       | tinyint | 否         | 权限类型 |
| permission | varchar | 否         | 权限标识 |
| name       | varchar | 否         | 权限名   |



### 8. 用户角色(tb_employee_role)

| 字段名      | 类型 | 是否可为空 | 描述   |
| ----------- | ---- | ---------- | ------ |
| employee_id | int  | 否         | 员工id |
| role_id     | int  | 否         | 角色id |



### 9. 角色权限(tb_role_menu)

| 字段名  | 类型 | 是否可为空 | 描述   |
| ------- | ---- | ---------- | ------ |
| role_id | int  | 否         | 角色id |
| menu_id | int  | 否         | 权限id |



### 10 商机(tb_business)

| 字段名        | 类型     | 是否可为空 | 描述                          |
| ------------- | -------- | ---------- | ----------------------------- |
| id            | int      | 否         | 商机id                        |
| customer_name | varchar  | 是         | 客户(企业)名称                |
| contact_man   | varchar  | 是         | 联系人                        |
| phone         | varchar  | 是         | 联系电话                      |
| desire        | varchar  | 是         | 意愿类型                      |
| status        | tinyint  | 否         | 状态,0:跟进中,1:已转化,2:丢弃 |
| worker        | varchar  | 是         | 负责人                        |
| end_time      | dateTime | 是         | 转化时间(即完成时间)          |
| create_by     | varchar  | 否         | 创建人                        |
| create_time   | datetime | 否         | 创建时间                      |
| update_by     | varchar  | 否         | 更新人                        |
| update_time   | datetime | 否         | 更新时间                      |



### 11 商机记录(tb_record)

| 字段名        | 类型     | 是否可空 | 描述     |
| ------------- | -------- | -------- | -------- |
| id            | int      | 否       | 记录id   |
| business_id   | int      | 否       | 商机id   |
| target        | varchar  | 是       | 沟通目标 |
| desire_change | varchar  | 是       | 意愿变化 |
| detail        | varchar  | 是       | 备注     |
| result        | varchar  | 否       | 沟通结果 |
| record_by     | varchar  | 否       | 记录人   |
| record_time   | datetime | 否       | 记录日期 |



### 12 项目(tb_contract)

| 字段名        | 类型     | 是否可空 | 描述                                   |
| ------------- | -------- | -------- | -------------------------------------- |
| id            | int      | 否       | 记录id                                 |
| business_id   | int      | 否       | 被转化的商机id,直接创建为0             |
| content       | varchar  | 否       | 项目内容                               |
| customer_name | varchar  | 否       | 客户名称                               |
| address       | varchar  | 是       | 客户地址                               |
| contact_man   | varchar  | 是       | 联系人                                 |
| phone         | varchar  | 是       | 联系电话                               |
| amount        | varchar  | 是       | 项目金额                               |
| sign_time     | datetime | 是       | 签订日期                               |
| pay_method    | varchar  | 是       | 收款方式                               |
| accept_time   | datetime | 是       | 验收日期                               |
| finish_time   | datetime | 是       | 项目完成时间                           |
| status        | tinyint  | 否       | 状态,0:开展中,1:待验收,2:待收款,3:完成 |
| worker        | varchar  | 否       | 负责人                                 |
| create_by     | varchar  | 否       | 创建人                                 |
| create_time   | datetime | 否       | 创建时间                               |
| update_by     | varchar  | 否       | 更新人                                 |
| update_time   | datetime | 否       | 更新时间                               |



### 13 货物清单(tb_goods_order)

| 字段名        | 类型     | 是否可空 | 描述                            |
| ------------- | -------- | -------- | ------------------------------- |
| id            | int      | 否       | 清单id                          |
| contract_id   | int      | 否       | 项目id,无则为0                  |
| order_content | varchar  | 否       | 清单概况                        |
| cost          | decimal  | 是       | 成本总金额                      |
| amount        | decimal  | 是       | 总金额                          |
| status        | tinyint  | 否       | 状态,0:待完善,1:未到货,2:已到货 |
| create_by     | varchar  | 否       | 创建人                          |
| create_time   | datetime | 否       | 创建时间                        |
| update_by     | varchar  | 否       | 更新人                          |
| update_time   | datetime | 否       | 更新时间                        |



### 14 清单明细(tb_goods_detail)

| 字段名       | 类型    | 是否可空 | 描述     |
| ------------ | ------- | -------- | -------- |
| id           | int     | 否       | 明细表id |
| goods_id     | int     | 否       | 清单id   |
| goods_name   | varchar | 否       | 商品名称 |
| brand        | varchar | 否       | 品牌     |
| count        | int     | 否       | 数量     |
| goods_cost   | decimal | 否       | 成本单价 |
| goods_amount | decimal | 否       | 单价     |

